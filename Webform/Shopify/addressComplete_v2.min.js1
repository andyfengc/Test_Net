function isPrintableKey(e){var t=e.keyCode,a=t>47&&58>t||32==t||t>64&&91>t||t>95&&112>t||t>185&&193>t||t>218&&223>t;return a}function isNonPrintableKey(e){return!isPrintableKey(e)}function isCombinationKeyPressed(e){return e.ctrlKey||e.altKey||e.shiftKey||e.metaKey}function selectItemByValue(e,t){for(var a=0;a<e.options.length;a++)if(e.options[a].value===t){e.selectedIndex=a;break}}function getMaxLengthMessage(){switch(getStore()){case store.Canada_Fr:case store.France:return" caractères restants ("+Max_Length+" maximum)";case store.Germany:return" characters remaining ("+Max_Length+" maximum)";case store.Spain:return" characters remaining ("+Max_Length+" maximum)";case store.Italy:return" characters remaining ("+Max_Length+" maximum)";case store.Portugal:return" characters remaining ("+Max_Length+" maximum)";case store.Australia:return" characters remaining ("+Max_Length+" maximum)";case store.Nederland:return" characters remaining ("+Max_Length+" maximum)";case store.UnitedKingdom:return" characters remaining ("+Max_Length+" maximum)";case store.Canada_En:case store.UnitedStates:default:return" characters remaining ("+Max_Length+" maximum)"}}function getMaxLengthReachMessage(){switch(getStore()){case store.Canada_Fr:case store.France:return"la longueur maximum de <b>"+Max_Length+"</b> caractères est atteint";case store.Germany:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.Spain:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.Italy:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.Portugal:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.Australia:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.Nederland:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.UnitedKingdom:return"the max length of <b>"+Max_Length+"</b> characters is reached";case store.Canada_En:case store.UnitedStates:default:return"the max length of <b>"+Max_Length+"</b> characters is reached"}}function validateMaxLength(e){var t,a=document.getElementById("checkout_shipping_address_address1").value;t=e&&("keypress"==e.type||"keydown"==e.type)?"8"==e.keyCode?0==a.length?a.length:a.length-1:isNonPrintableKey(e)||isCombinationKeyPressed(e)?a.length:a.length+1:a.length;var s=document.getElementById("maxLength");if(t>Max_Length)address1=document.getElementById("checkout_shipping_address_address1"),address1.parentNode.className="field field--required field--error field--focus",s.innerHTML=getMaxLengthReachMessage();else{address1=document.getElementById("checkout_shipping_address_address1"),address1.parentNode.className="field field--required";var r=Max_Length-t;s.innerHTML=r+getMaxLengthMessage()}}function fillInAddress(){var e=autocomplete.getPlace();for(var t in componentForm)document.getElementById(componentForm[t]).value="",document.getElementById(componentForm[t]).disabled=!1;for(var a,s,r,n,o="",d=0;d<e.address_components.length;d++){var i=e.address_components[d].types[0];if(componentFormMapping[i]){var c=e.address_components[d][componentFormMapping[i]];"street_number"==i&&(o+=c),"route"==i&&(o+=""!=o?" "+c:c),"locality"==i?r=c:"postal_code"==i?n=c:"country"==i?a=c:s=c}}o&&(document.getElementById("checkout_shipping_address_address1").value=o),r&&(document.getElementById("checkout_shipping_address_city").value=r),n&&(document.getElementById("checkout_shipping_address_zip").value=n),s&&("Québec"==s&&(s="Quebec"),selectItemByValue(document.getElementById("checkout_shipping_address_province"),s)),validateMaxLength(),document.activeElement.blur()}if(window.store={Canada_En:/ca.kobo/i,Canada_Fr:/ca-fr.kobo/i,UnitedStates:/us.kobo/i,Germany:/de.kobo/i,Spain:/es.kobo/i,Italy:/it.kobo/i,Portugal:/pt.kobo/i,France:/fr.kobo/i,Australia:/au.kobo/i,Nederland:/nz.kobo/i,UnitedKingdom:/uk.kobo/i,RkbTest:/checkout.shopify/i,Localhost:/localhost:/i},window.getStore=function(){var e=window.location.href;return store.Canada_En.test(e)?store.Canada_En:store.Canada_Fr.test(e)?store.Canada_Fr:store.UnitedStates.test(e)?store.UnitedStates:store.Germany.test(e)?store.Germany:store.Spain.test(e)?store.Spain:store.Italy.test(e)?store.Italy:store.Portugal.test(e)?store.Portugal:store.France.test(e)?store.France:store.Australia.test(e)?store.Australia:store.Nederland.test(e)?store.Nederland:store.UnitedKingdom.test(e)?store.UnitedKingdom:store.RkbTest.test(e)?store.Canada_En:store.Localhost.test(e)?store.Nederland:void 0},window.getCountryCode=function(){switch(getStore()){case store.UnitedStates:return"US";case store.Germany:return"DE";case store.Spain:return"ES";case store.Italy:return"IT";case store.Portugal:return"PT";case store.France:return"FR";case store.Australia:return"AU";case store.Nederland:return"NL";case store.UnitedKingdom:return"GB";case store.Canada_En:case store.Canada_Fr:default:return"CA"}},window.getCountryLanguageCode=function(){switch(getStore()){case store.Canada_Fr:case store.France:return"fr";case store.Germany:return"de";case store.Spain:return"es";case store.Italy:return"it";case store.Portugal:return"pt-PT";case store.Australia:return"en-AU";case store.Nederland:return"nl";case store.UnitedKingdom:return"en-GB";case store.Canada_En:case store.UnitedStates:default:return"en"}},getStore()==store.UnitedStates){var text=document.getElementById("checkout_shipping_address_address1");text.parentNode.innerHTML+='<p id="message" class="field__error-message warning"></p>';var message=document.getElementById("message");message.innerHTML="Kobo does not ship to PO Boxes and will require a street address for delivery";var text=document.getElementById("checkout_shipping_address_address1"),poBoxText="PO BOX;POBOX;P O BOX;P OBOX;P.O.BOX;P.O BOX;P.OBOX;P.O. BOX;P. O. BOX;PO.BOX;P O.BOX;P O. BOX;PO. BOX".split(";"),show=!1,showText=!1;"field field--required field--error"==text.parentNode.className&&(show=!0),message.style.display=1==showText?"display":"none"}var Max_Length=35,fields="checkout_shipping_address_first_name checkout_shipping_address_last_name checkout_shipping_address_address1 checkout_shipping_address_address2 checkout_shipping_address_city checkout_shipping_address_zip checkout_shipping_address_phone checkout_billing_address_first_name checkout_billing_address_last_name checkout_billing_address_address1 checkout_billing_address_address2 checkout_billing_address_city checkout_billing_address_zip checkout_billing_address_phone".split(" ");for(i=0;i<fields.length;i++)document.getElementById(fields[i]).maxLength=Max_Length;var componentForm=["checkout_shipping_address_city","checkout_shipping_address_zip","checkout_shipping_address_province"],placeSearch,autocomplete,componentFormMapping={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"long_name",country:"long_name",postal_code:"short_name"},address1=document.getElementById("checkout_shipping_address_address1");address1.parentNode.innerHTML=address1.parentNode.innerHTML+'<p id="maxLength" class="field__error-message warning"></p>';var maxLength=document.getElementById("maxLength");address1=document.getElementById("checkout_shipping_address_address1"),address1.maxLength=Max_Length,maxLength.style.display="block";var currentLeftLength=Max_Length;maxLength.innerHTML=currentLeftLength+getMaxLengthMessage(),address1.onkeydown=validateMaxLength,address1.onblur=validateMaxLength;var select=document.getElementById("checkout_shipping_address_country"),country=select.options[select.selectedIndex].value;if("United States"==country){var text=document.getElementById("checkout_shipping_address_address1"),message=document.getElementById("message");for(text.onkeyup=function(e){for(showText=!1,i=0;i<poBoxText.length;i++)if(-1!=text.value.toLowerCase().indexOf(poBoxText[i].toLowerCase())){showText=!0;break}1==showText?(text.parentNode.className="field field--required field--error field--focus",message.style.display="block"):(text.parentNode.className=show?"field field--required field--error field--focus":"field field--required field--focus",message.style.display="none")},i=0;i<poBoxText.length;i++)if(-1!=text.value.toLowerCase().indexOf(poBoxText[i].toLowerCase())){showText=!0;break}}window.initAutocomplete=function(){var e={types:["address"],componentRestrictions:{country:getCountryCode()}};""==e.componentRestrictions.country&&delete e.componentRestrictions;var t=document.getElementById("checkout_shipping_address_address1");google.maps.event.addDomListener(t,"keydown",function(e){13==e.keyCode&&e.preventDefault()}),autocomplete=new google.maps.places.Autocomplete(document.getElementById("checkout_shipping_address_address1"),e),autocomplete.addListener("place_changed",fillInAddress)};var googleMapEventListenerScript=document.createElement("script");googleMapEventListenerScript.async=!0,googleMapEventListenerScript.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwO_kj1b7YdHj_Gp567LepbrRGW4s-n4s&signed_in=true&libraries=places&callback=initAutocomplete&language="+getCountryLanguageCode(),document.getElementsByTagName("head")[0].appendChild(googleMapEventListenerScript);