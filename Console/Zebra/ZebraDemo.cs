using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Threading.Tasks;

namespace Console.Zebra
{
    /// <summary>
    /// http://labelary.com/service.html
    /// </summary>
    public class ZebraDemo
    {
        private static string helloLabel = "^xa^cfa,50^fo100,100^fdHello World^fs^xz";
        private static string upsLabel = "^XA^LRN^MNY^MFN,N^LH10,12^MCY^POI^PW812^CI27 ^FO620,1140 ^GFA,00969,00969,019,FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 F0000000000001F8000000000000F000000000 F0000000000001F8000000000000F000000000 F0000000003F81F83FC000000000F000000000 F0000000003F81F83FC000000000F000000000 F000000000FFF9F9FFF000000000F000000000 F000000000FFF9F9FFF000000000F000000000 F000000000FFFFFFFFFC00000000F000000000 F000000000FFFFFFFFFC00000000F000000000 F000000000F07FFFF0FC00000000F000000000 F000000000F07FFFF0FC00000000F000000000 F000000000FC1FFFC3F000000000F000000000 F000000000FC1FFFC3F000000000F000000000 F000000000FFFFFFFFF000000000F000000000 F000000000FFFFFFFFF000000000F000000000 F0000000003FFFFFFFC000000000F000000000 F0000000003FFFFFFFC000000000F000000000 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000 F00000000001FFFFF00000000000F000000000 F00000000001FFFFF00000000000F000000000 F00000000003FFF9FC0000000000F000000000 F00000000003FFF9FC0000000000F000000000 F0000000003FE1F87FC000000000F000000000 F0000000003FE1F87FC000000000F000000000 F000000000FF81F83FF000000000F000000000 F000000000FF81F83FF000000000F000000000 F000000000FE01F803F000000000F000000000 F000000000FE01F803F000000000F000000000 F000000000F001F800F000000000F000000000 F000000000F001F800F000000000F000000000 F0000000000001F8000000000000F000000000 F0000000000001F8000000000000F0FFDC1C00 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF0FFDC1C00 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF00C1E3C00 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF00C1E3C00 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF00C1A2C00 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF00C1B6C00 FFFFFFFFFFFFFFFFFFFFFFFFFFFFF00C1B6C00 0000000000000000000000000000000C1B6C00 0000000000000000000000000000000C19CC00 0000000000000000000000000000000C19CC00 0000000000000000000000000000000C19CC00 0000000000000000000000000000000C188C00 00000000000000000000000000000000000000 00000000000000000000000000000000000000 00000000000000000000000000000000000000 ^DN ^FT20,630^CVY^BD2^FH_^FD068840971320000[)>_1E01_1D961Z98756148_1DUPSN_1D1YA077_1E07_1DP,_1D-155L$& \"()E1AC)+9D.#/+EVF$HP/)YHJY5+$S_0D_1E_04^FS ^FT15,23^A0N,20,24^FVKeBe INC.^FS ^FT15,42^A0N,20,24^FV1-416-977-8737^FS ^FT15,61^A0N,20,24^FVKeBe INC.^FS ^FT15,81^A0N,20,24^FV135 LIBERTY ST. SUITE 101^FS ^FT15,100^A0N,20,24^FVTORONTO ON M6K1A7^FS ^FT15,119^A0N,20,24^FVCANADA^FS ^FT60,181^A0N,26,30^FVDAVID HOWARD^FS ^FT60,208^A0N,26,30^FV503-538-1738^FS ^FT60,236^A0N,26,30^FVDAVID HOWARD^FS ^FT60,263^A0N,26,30^FV301 E. COLUMBIA DR. #37^FS ^FT60,307^A0N,45,44^FVNEWBERG OR 97132^FS ^FT60,349^A0N,45,44^FVUNITED STATES^FS ^FT380,30^A0N,30,34^FV1 LBS ^FS ^FT673,34^A0N,28,32^FV 1 OF 1^FS ^FT500,69^A0N,22,26^FVSHP#: 1YA0 77VN WXF^FS ^FT500,91^A0N,22,26^FVSHP WT: 1 LBS^FS ^FT500,113^A0N,22,26^FVSHP DWT: 1 LBS^FS ^FT500,136^A0N,22,26^FVDATE: 05 NOV 2015^FS ^FT620,736^A0N,100,76^FV ^FS ^FO677,640^GB123,123,122^FS ^FT300,618^BY3^BCN,103,N,N,,A^FV42184097132^FS ^FT290,493^A0N,80,70^FVOR 970 9-62^FS ^FT10,704^A0N,56,58^FVUPS STANDARD^FS ^FT10,737^A0N,26,30^FVTRACKING #: 1Z 1YA 077 68 9875 6148^FS ^FO0,762^GB800,4,4^FS ^FT790,1039^A0N,22,26^FV ^FS ^FT10,1035^A0N,22,26^FVBILLING: ^FS ^FT126,1035^A0N,22,26^FVP/P ^FS ^FT10,1059^A0N,22,26^FVDESC: Shipment request created at 11^FS ^FT613,1068^A0N,60,64^FVEDI^FS ^FT15,153^A0N,28,32^FVSHIP TO: ^FS ^FO0,637^GB798,14,14^FS ^FO0,997^GB800,14,14^FS ^FO0,416^GB800,4,4^FS ^FO240,416^GB3,221,3^FS ^FT190,1188^A0N,14,20^FVXOL 15.10.12 NV45 69.0A 10/2015^FS ^FT105,982^BY3^BCN,202,N,N,,A^FV1Z1YA0776898756148^FS ^XZ^XZ";

        public static void GetALabel()
        {
            byte[] zpl = Encoding.UTF8.GetBytes(upsLabel);

            // adjust print density (8dpmm), label width (4 inches), label height (6 inches), and label index (0) as necessary
            var request = (HttpWebRequest)WebRequest.Create("http://api.labelary.com/v1/printers/8dpmm/labels/4x6/0/");
            request.Method = "POST";
            request.Accept = "application/pdf"; // omit this line to get PNG images back
            request.ContentType = "application/x-www-form-urlencoded";
            request.ContentLength = zpl.Length;

            var requestStream = request.GetRequestStream();
            requestStream.Write(zpl, 0, zpl.Length);
            requestStream.Close();

            try
            {
                var response = (HttpWebResponse)request.GetResponse();
                var responseStream = response.GetResponseStream();
                var fileStream = File.Create("d:/label.pdf"); // change file name for PNG images
                responseStream.CopyTo(fileStream);
                responseStream.Close();
                fileStream.Close();
            }
            catch (WebException e)
            {
                System.Console.WriteLine("Error: {0}", e.Status);
            }
        }
    }
}
